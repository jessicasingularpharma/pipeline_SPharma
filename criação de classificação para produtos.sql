SELECT * FROM gold.mat_view_produtos_fornecedores
CREATE INDEX idx_produtos_cdpro ON gold.produtos("CDPRO");
CREATE INDEX idx_produtosporfornecedor_cdpro ON silver.produtosporfornecedor(CAST("CDPRO" AS integer));
CREATE INDEX idx_produtosporfornecedor_fornecid ON silver.produtosporfornecedor("FORNECID");
CREATE INDEX idx_fornecedores_fornecid ON gold.fornecedores("fornecid");

-- 1. Adicionar a nova coluna CLASSIFICACAO
ALTER TABLE gold.produtos
ADD COLUMN "CLASSIFICACAO" VARCHAR(20);

-- 2. Atualizar os registros para CLASSIFICACAO = 'BLEND' com base nos códigos fornecidos
UPDATE gold.produtos
SET "CLASSIFICACAO" = 'BLEND'
WHERE "CDPRO" IN (
    71208, 71728, 70115, 64970, 38079, 70668, 59772, 31033, 34188, 69778, 
    10327, 36614, 60340, 24845, 53709, 53714, 53713, 53716, 53710, 53711, 
    53719, 24417, 2406, 69346, 29505, 53728, 63519, 4342, 29766, 33092, 
    68900, 33212, 8930, 68232, 699, 53026, 58859, 306, 49592, 68249, 63479, 
    62570, 65836, 58856, 63432, 61675, 70039, 72046, 70711, 70902, 63165, 
    67355, 66478, 71442, 1738, 57874, 33899, 68483, 49593, 51613, 62535, 
    65908, 71497, 69137, 64905, 63685, 53382, 65720, 67772, 71415, 68027, 
    70330, 72164, 70651, 63628, 63521, 65630, 63698, 70921, 72334, 72487, 
    68330, 62380, 71923, 70861, 70720, 71197, 72506, 72508, 72507, 72505, 
    72274, 62383, 70372, 65822, 72477, 62655, 72030, 70371, 65382, 69388, 
    67963, 63731, 63700, 71636, 65944, 64448, 72071, 72247, 68131, 68571, 
    71115, 71085, 70454, 63191, 22508, 70835, 67993, 67964, 70817, 65907, 
    71653, 70894, 65227, 70978, 71090, 63396, 65725, 71259, 56623, 69328, 
    71088, 61189, 64154, 8978, 63441, 71060, 70783, 71014, 71243, 62152, 
    70941, 70567, 63616, 8871, 70633, 53735, 67536, 39428, 71518, 63436, 
    53841, 62130, 71519, 67689, 71624, 61605, 64185, 66247, 8694, 67690, 
    67686, 70885, 8909, 70485, 66929, 59658, 67378, 53995, 71641, 72245, 
    70937, 65101, 71693, 65570, 67855, 65571, 62233, 71716, 71238, 64802, 
    63784, 72201, 69749, 72214, 33697, 70958, 67163, 53868, 72215, 64192, 
    56591, 63550, 70103, 72212, 63247, 71400, 63248, 66252, 65716, 71613, 
    59546, 63249, 62922, 38618, 65305, 53237, 53239, 53238, 53247, 59660, 
    46530, 53485, 69359, 63098, 71026, 62373, 58901, 2016, 66552, 70509, 
    72022, 70649, 70648, 34475, 34476,1659,1760,1765,1853,1867,1930,2123,2450,
	2764,3298,4438,4885,5009,5905,7245,23082,28098,38563,38722,38753,39426,39491,
	53379,53381,53619,53621,53758,58705,58894,58952,60270,61390,61403,61605,61675,
	62229,62380,62726,62922,63548,63550,63616,63628,63685,63698,63700,63726,64531,
	64565,64802,64825,64927,65258,65466,65745,66838,67204,67481,67519,67527,6775,67774,
	68707,6904,69056,69057,69058,69068,69327,69510,69515,70043,70047,70125,70162,70245,70265,
	70301,70522,70591,70797,70836,70891,71296,71710,71727,71760,71779,71856,71857,72068,72190
);

-- 3. Atualizar os registros restantes para CLASSIFICACAO = 'OUTROS'
UPDATE gold.produtos
SET "CLASSIFICACAO" = 'OUTROS'
WHERE "CLASSIFICACAO" IS NULL;


-- 1. Atualizar os registros para CLASSIFICACAO = 'EMERGENTES' com base nos novos códigos fornecidos
UPDATE gold.produtos
SET "CLASSIFICACAO" = 'EMERGENTES'
WHERE "CDPRO" IN (
    61012, 69416, 28597, 29490, 51470, 9437, 63310, 45913, 
    32786, 28558, 28559, 70926, 62320, 62641, 4869, 69510
);

-- 2. Atualizar os registros restantes para CLASSIFICACAO = 'OUTROS'
-- Certifique-se de que apenas os registros que não sejam BLEND ou EMERGENTES sejam classificados como OUTROS.
UPDATE gold.produtos
SET "CLASSIFICACAO" = 'OUTROS'
WHERE "CDPRO" IN (
        69778, 2016, 1738
);





DELETE FROM gold.combined_notasfiscais
WHERE "CDFIL" = '001';
